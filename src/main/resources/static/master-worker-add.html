<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>管理员主界面</title>
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="http://cdn.jsdelivr.net/vue/1.0.18/vue.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <script src="common.js" rel="stylesheet"></script>
    <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>

    <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</head>
<body style="background-color: #87CEFF">

<div class="navbar navbar-duomi navbar-static-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#" id="logo">家政信息服务系统管理员端
            </a>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2">
            <ul id="main-nav" class="nav nav-tabs nav-stacked">
                <li>
                    <a href="#product" class="nav-header collapsed" data-toggle="collapse">

                        商品管理
                        <span class="pull-right glyphicon glyphicon-chevron-down"></span>
                    </a>
                    <ul id="product" class="nav nav-list collapse secondmenu" style="height: 0px;">
                        <li><a href="#" onclick="jumpWithToken('master-product.html',token);">商品查询</a></li>
                        <li><a href="#" onclick="jumpWithToken('master-product-create.html',token);">商品发布</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#worker" class="nav-header collapsed" data-toggle="collapse">

                        员工管理
                        <span class="pull-right glyphicon glyphicon-chevron-down"></span>
                    </a>
                    <ul id="worker" class="nav nav-list collapse secondmenu" style="height: 0px;">
                        <li><a href="#" onclick="jumpWithToken('master-worker.html',token);">员工信息</a></li>
                        <li><a href="#" onclick="jumpWithToken('master-worker-add.html',token);">添加员工</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#" onclick="jumpWithToken('master-order.html',token);">订单管理</a>
                </li>


            </ul>
        </div>
        <div class="col-md-10">
            <div id="app">
                <ul>
                    <li>姓名：<input v-model="name"> </li>
                    <li>生日：<input v-model="birthday"> </li>
                    <li>微信：<input v-model="wechat"> </li>
                    <li>电话：<input v-model="telephone"> </li>

                    <li><button v-on:click="update()">确定</button></li>
                </ul>

            </div>
        </div>
    </div>
</div>

<script>
    var token = null;
    var vm = new Vue({
        el: '#app',
        data: {
            id: null,
            name: null,
            birthday: null,
            wechat: null,
            telephone: null
        },
        methods:{
            update: function () {
                var t = this;
                $.ajax({
                    type: "POST",
                    dataType: "json",
                    contentType:'application/json;charset=UTF-8',
                    data: JSON.stringify({
                        id: this.id,
                        name: this.name,
                        birthday: this.birthday,
                        wechat: this.wechat,
                        telephone: this.telephone
                    }),
                    url: PREFIX + "master/worker?token="+token,
                    success: function (data) {
                        if (t.id == null) {
                            alert("创建成功！");
                        } else {
                            alert("修改成功！");
                        }
                        refresh(data);
                    },
                    error: function (data) {
                        alert(data.responseText.message);
                    }
                });
            }
        }
    });
    window.onload = function () {
        validateMaster();
        var id=getQueryString("id");
        token=getQueryString("token");
        if(id!=null&&id!=undefined){
            initWorker(id);
        }
    };
    function initWorker(id) {
        $.ajax({
            type: "GET",
            dataType: "json",
            contentType: 'application/json;charset=UTF-8',
            url: PREFIX + "master/worker/"+id+"?token=" + token,
            success: function (data) {
                refresh(data);
            },
            error: function (data) {}
        });
    }
</script>
</body>
</html>